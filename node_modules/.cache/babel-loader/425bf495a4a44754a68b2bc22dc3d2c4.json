{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.string.replace\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.MarkdownNavbar = void 0;\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar MarkdownNavbar = /*#__PURE__*/function (_Component) {\n  _inherits(MarkdownNavbar, _Component);\n\n  function MarkdownNavbar(props) {\n    var _this;\n\n    _classCallCheck(this, MarkdownNavbar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(MarkdownNavbar).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getCurrentHashValue\", function () {\n      return decodeURIComponent(window.location.hash.replace(/^#/, ''));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"winScroll\", function () {\n      if (_this.scrollEventLock) return;\n      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n\n      var newHeadingList = _this.getHeadingList().map(function (h) {\n        return _objectSpread({}, h, {\n          distanceToTop: Math.abs(scrollTop + _this.props.headingTopOffset - h.offsetTop)\n        });\n      });\n\n      var distanceList = newHeadingList.map(function (h) {\n        return h.distanceToTop;\n      });\n      var minDistance = Math.min.apply(Math, _toConsumableArray(distanceList));\n      var curHeading = newHeadingList.find(function (h) {\n        return h.distanceToTop === minDistance;\n      });\n\n      if (_this.props.updateHashAuto) {\n        // Hash changing callback\n        if (curHeading.dataId !== _this.getCurrentHashValue()) {\n          _this.props.onHashChange(curHeading.dataId, _this.getCurrentHashValue());\n        }\n\n        _this.updateHash(curHeading.dataId);\n      }\n\n      _this.setState({\n        currentListNo: curHeading.listNo\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"winHashChange\", function () {\n      _this.scrollToTarget(_this.getCurrentHashValue());\n    });\n\n    _this.state = {\n      currentListNo: ''\n    };\n    return _this;\n  }\n\n  _createClass(MarkdownNavbar, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.addTargetTimeout) {\n        clearTimeout(this.addTargetTimeout);\n      }\n\n      this.addTargetTimeout = setTimeout(function () {\n        _this2.initHeadingsId();\n\n        document.addEventListener('scroll', _this2.winScroll, false);\n        window.addEventListener('hashchange', _this2.winHashChange, false);\n      }, 500);\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      var _this3 = this;\n\n      if (nextProps.source !== this.props.source) {\n        if (this.scrollEventLockTimer) {\n          clearTimeout(this.scrollEventLockTimer);\n        }\n\n        this.scrollEventLock = true;\n        window.scrollTo(0, 0);\n        this.setState({\n          currentListNo: ''\n        });\n        var headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');\n        Array.prototype.slice.apply(headings).forEach(function (h) {\n          return h.dataset.id = '';\n        });\n        this.scrollEventLockTimer = setTimeout(function () {\n          _this3.initHeadingsId();\n\n          _this3.scrollEventLock = false;\n        }, 500);\n      }\n\n      return true;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.addTargetTimeout) {\n        clearTimeout(this.addTargetTimeout);\n      }\n\n      if (this.scrollTimeout) {\n        clearTimeout(this.scrollTimeout);\n      }\n\n      document.removeEventListener('scroll', this.winScroll, false);\n      window.removeEventListener('hashchange', this.winHashChange, false);\n    }\n  }, {\n    key: \"getNavStructure\",\n    value: function getNavStructure() {\n      var contentWithoutCode = this.props.source.replace(/^[^#]+\\n/g, '').replace(/^#\\s[^#\\n]*\\n+/, '').replace(/```[^`\\n]*\\n+[^```]+```\\n+/g, '').replace(/`([^`\\n]+)`/g, '$1').replace(/\\*\\*?([^*\\n]+)\\*\\*?/g, '$1').replace(/__?([^_\\n]+)__?/g, '$1').trim();\n      var pattOfTitle = /#+\\s([^#\\n]+)\\n*/g;\n      var matchResult = contentWithoutCode.match(pattOfTitle);\n\n      if (!matchResult) {\n        return [];\n      }\n\n      var navData = matchResult.map(function (r, i) {\n        return {\n          index: i,\n          level: r.match(/^#+/g)[0].length,\n          text: r.replace(pattOfTitle, '$1')\n        };\n      });\n\n      var levelCount = function levelCount(level) {\n        return navData.filter(function (r) {\n          return r.level === level;\n        }).length;\n      };\n\n      var startLevel = 1;\n      var startLevelCount = levelCount(startLevel);\n\n      while (!startLevelCount) {\n        startLevel += 1;\n        startLevelCount = levelCount(startLevel);\n      }\n\n      var listNo = 1;\n      navData.forEach(function (t) {\n        if (t.level === startLevel) {\n          t.listNo = listNo.toString();\n          listNo += 1;\n        }\n      });\n      navData.forEach(function (t, i) {\n        if (!t.listNo) {\n          if (navData[i - 1] && t.level === navData[i - 1].level + 1) {\n            t.listNo = \"\".concat(navData[i - 1].listNo, \".1\");\n          } else if (navData[i - 1] && t.level === navData[i - 1].level) {\n            t.listNo = navData[i - 1].listNo.replace(/^(.+\\.)(\\d+)$/g, function (w, $1, $2) {\n              return \"\".concat($1).concat(parseInt($2, 10) + 1);\n            });\n          } else {\n            t.listNo = '';\n          }\n        }\n      });\n      var result = navData.map(function (nav) {\n        return _objectSpread({}, nav, {\n          listNo: nav.listNo.indexOf('.') < 0 ? \"\".concat(nav.listNo, \".\") : nav.listNo,\n          text: nav.text\n        });\n      });\n      return result;\n    }\n  }, {\n    key: \"scrollToTarget\",\n    value: function scrollToTarget(dataId) {\n      var _this4 = this;\n\n      if (this.scrollTimeout) {\n        clearTimeout(this.scrollTimeout);\n      }\n\n      this.scrollTimeout = setTimeout(function () {\n        var target = document.querySelector(\"[data-id=\\\"\".concat(dataId, \"\\\"]\"));\n\n        if (target && typeof target.offsetTop === 'number') {\n          window.scrollTo(0, target.offsetTop - _this4.props.headingTopOffset);\n        }\n      }, 0);\n    }\n  }, {\n    key: \"initHeadingsId\",\n    value: function initHeadingsId() {\n      var _this5 = this;\n\n      var headingId = decodeURIComponent(this.props.declarative ? window.location.hash.replace(/^#/, '').trim() : (window.location.hash.match(/heading-\\d+/g) || [])[0]);\n      this.getNavStructure().forEach(function (t) {\n        var headings = document.querySelectorAll(\"h\".concat(t.level));\n        var curHeading = Array.prototype.slice.apply(headings).find(function (h) {\n          return h.innerText === t.text && (!h.dataset || !h.dataset.id);\n        });\n\n        if (curHeading) {\n          curHeading.dataset.id = _this5.props.declarative ? t.text : \"heading-\".concat(t.index);\n\n          if (headingId && headingId === curHeading.dataset.id) {\n            _this5.scrollToTarget(headingId);\n\n            _this5.setState({\n              currentListNo: t.listNo\n            });\n          }\n        }\n      });\n    }\n  }, {\n    key: \"getHeadingList\",\n    value: function getHeadingList() {\n      var _this6 = this;\n\n      var headingList = [];\n      this.getNavStructure().forEach(function (t) {\n        var headings = document.querySelectorAll(\"h\".concat(t.level));\n        var curHeading = Array.prototype.slice.apply(headings).find(function (h) {\n          return h.innerText === t.text && !headingList.find(function (x) {\n            return x.offsetTop === h.offsetTop;\n          });\n        });\n\n        if (curHeading) {\n          headingList.push({\n            dataId: _this6.props.declarative ? t.text : \"heading-\".concat(t.index),\n            listNo: t.listNo,\n            offsetTop: curHeading.offsetTop\n          });\n        }\n      });\n      return headingList;\n    }\n  }, {\n    key: \"updateHash\",\n    value: function updateHash(value) {\n      window.history.replaceState({}, '', \"\".concat(window.location.pathname).concat(window.location.search, \"#\").concat(value));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this7 = this;\n\n      var tBlocks = this.getNavStructure().map(function (t) {\n        var cls = \"title-anchor title-level\".concat(t.level, \" \").concat(_this7.state.currentListNo === t.listNo ? 'active' : '');\n        return _react.default.createElement(\"div\", {\n          className: cls,\n          onClick: function onClick(evt) {\n            var currentHash = _this7.props.declarative ? t.text : \"heading-\".concat(t.index); // Avoid execution the callback `onHashChange` when clicking current nav item\n\n            if (t.listNo !== _this7.state.currentListNo) {\n              // Hash changing callback\n              _this7.props.onHashChange(currentHash, _this7.getCurrentHashValue());\n            } // Nav item clicking callback\n\n\n            _this7.props.onNavItemClick(evt, evt.target, currentHash);\n\n            _this7.updateHash(currentHash);\n\n            _this7.scrollToTarget(currentHash);\n\n            _this7.setState({\n              currentListNo: t.listNo\n            });\n          },\n          key: \"title_anchor_\".concat(Math.random().toString(36).substring(2))\n        }, _this7.props.ordered ? _react.default.createElement(\"small\", null, t.listNo) : null, t.text);\n      });\n      return _react.default.createElement(\"div\", {\n        className: \"markdown-navigation \".concat(this.props.className)\n      }, tBlocks);\n    }\n  }]);\n\n  return MarkdownNavbar;\n}(_react.Component);\n\nexports.MarkdownNavbar = MarkdownNavbar;\n\n_defineProperty(MarkdownNavbar, \"propTypes\", {\n  source: _propTypes.default.string.isRequired,\n  ordered: _propTypes.default.bool,\n  headingTopOffset: _propTypes.default.number,\n  updateHashAuto: _propTypes.default.bool,\n  declarative: _propTypes.default.bool,\n  className: _propTypes.default.string,\n  onNavItemClick: _propTypes.default.func,\n  onHashChange: _propTypes.default.func\n});\n\n_defineProperty(MarkdownNavbar, \"defaultProps\", {\n  source: '',\n  ordered: true,\n  headingTopOffset: 0,\n  updateHashAuto: true,\n  declarative: false,\n  className: '',\n  onNavItemClick: function onNavItemClick() {},\n  onHashChange: function onHashChange() {}\n});\n\nvar _default = MarkdownNavbar;\nexports.default = _default;","map":{"version":3,"sources":["../src/index.js"],"names":["MarkdownNavbar","Component","source","PropTypes","ordered","headingTopOffset","updateHashAuto","declarative","className","onNavItemClick","onHashChange","func","currentListNo","clearTimeout","setTimeout","document","window","nextProps","headings","Array","h","contentWithoutCode","pattOfTitle","matchResult","navData","index","level","r","text","levelCount","startLevel","startLevelCount","listNo","t","i","parseInt","result","nav","dataId","target","headingId","decodeURIComponent","curHeading","headingList","x","offsetTop","scrollTop","newHeadingList","distanceToTop","Math","distanceList","minDistance","value","tBlocks","cls","currentHash","evt"],"mappings":";;;;;;;;;;;AAAA,IAAA,MAAA,GAAA,uBAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AACA,IAAA,UAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,YAAA,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEaA,c;;;AAuBX,WAAA,cAAA,CAAA,KAAA,EAAmB;AAAA,QAAA,KAAA;;AAAA,IAAA,eAAA,CAAA,IAAA,EAAA,cAAA,CAAA;;AACjB,IAAA,KAAA,GAAA,0BAAA,CAAA,IAAA,EAAA,eAAA,CAAA,cAAA,CAAA,CAAA,IAAA,CAAA,IAAA,EAAA,KAAA,CAAA,CAAA;;AADiB,IAAA,eAAA,CAAA,sBAAA,CAAA,KAAA,CAAA,EAAA,qBAAA,EAmLG,YAAA;AAAA,aACpByC,kBAAkB,CAACzB,MAAM,CAANA,QAAAA,CAAAA,IAAAA,CAAAA,OAAAA,CAAAA,IAAAA,EADC,EACDA,CAAD,CADE;AAnLH,KAAA,CAAA;;AAAA,IAAA,eAAA,CAAA,sBAAA,CAAA,KAAA,CAAA,EAAA,WAAA,EAsLP,YAAM;AAChB,UAAI,KAAA,CAAJ,eAAA,EAA0B;AAE1B,UAAM8B,SAAS,GACb9B,MAAM,CAANA,WAAAA,IACAD,QAAQ,CAARA,eAAAA,CADAC,SAAAA,IAEAD,QAAQ,CAARA,IAAAA,CAFAC,SAAAA,IADF,CAAA;;AAMA,UAAM+B,cAAc,GAAG,KAAA,CAAA,cAAA,GAAA,GAAA,CAA0B,UAAA,CAAA,EAAC;AAAA,eAAA,aAAA,CAAA,EAAA,EAAA,CAAA,EAAA;AAEhDC,UAAAA,aAAa,EAAEC,IAAI,CAAJA,GAAAA,CACbH,SAAS,GAAG,KAAA,CAAA,KAAA,CAAZA,gBAAAA,GAA0C1B,CAAC,CAD9B6B,SAAAA;AAFiC,SAAA,CAAA;AAAlD,OAAuB,CAAvB;;AAMA,UAAMC,YAAY,GAAG,cAAc,CAAd,GAAA,CAAmB,UAAA,CAAA,EAAC;AAAA,eAAI9B,CAAC,CAAL,aAAA;AAAzC,OAAqB,CAArB;AACA,UAAM+B,WAAW,GAAGF,IAAI,CAAJA,GAAAA,CAAAA,KAAAA,CAAAA,IAAAA,EAAI,kBAAA,CAAxB,YAAwB,CAAJA,CAApB;AACA,UAAMP,UAAU,GAAG,cAAc,CAAd,IAAA,CACjB,UAAA,CAAA,EAAC;AAAA,eAAItB,CAAC,CAADA,aAAAA,KAAJ,WAAA;AADH,OAAmB,CAAnB;;AAIA,UAAI,KAAA,CAAA,KAAA,CAAJ,cAAA,EAA+B;AAC7B;AACA,YAAIsB,UAAU,CAAVA,MAAAA,KAAsB,KAAA,CAA1B,mBAA0B,EAA1B,EAAsD;AACpD,UAAA,KAAA,CAAA,KAAA,CAAA,YAAA,CAAwBA,UAAU,CAAlC,MAAA,EAA2C,KAAA,CAA3C,mBAA2C,EAA3C;AACD;;AAED,QAAA,KAAA,CAAA,UAAA,CAAgBA,UAAU,CAA1B,MAAA;AACD;;AACD,MAAA,KAAA,CAAA,QAAA,CAAc;AACZ9B,QAAAA,aAAa,EAAE8B,UAAU,CAACV;AADd,OAAd;AAnNiB,KAAA,CAAA;;AAAA,IAAA,eAAA,CAAA,sBAAA,CAAA,KAAA,CAAA,EAAA,eAAA,EAwNH,YAAM;AACpB,MAAA,KAAA,CAAA,cAAA,CAAoB,KAAA,CAApB,mBAAoB,EAApB;AAzNiB,KAAA,CAAA;;AAEjB,IAAA,KAAA,CAAA,KAAA,GAAa;AACXpB,MAAAA,aAAa,EAAE;AADJ,KAAb;AAFiB,WAAA,KAAA;AAKlB;;;;wCAEmB;AAAA,UAAA,MAAA,GAAA,IAAA;;AAClB,UAAI,KAAJ,gBAAA,EAA2B;AACzBC,QAAAA,YAAY,CAAC,KAAbA,gBAAY,CAAZA;AACD;;AACD,WAAA,gBAAA,GAAwBC,UAAU,CAAC,YAAM;AACvC,QAAA,MAAI,CAAJ,cAAA;;AACAC,QAAAA,QAAQ,CAARA,gBAAAA,CAAAA,QAAAA,EAAoC,MAAI,CAAxCA,SAAAA,EAAAA,KAAAA;AACAC,QAAAA,MAAM,CAANA,gBAAAA,CAAAA,YAAAA,EAAsC,MAAI,CAA1CA,aAAAA,EAAAA,KAAAA;AAHgC,OAAA,EAAlC,GAAkC,CAAlC;AAKD;;;0CAEqBC,S,EAAW;AAAA,UAAA,MAAA,GAAA,IAAA;;AAC/B,UAAIA,SAAS,CAATA,MAAAA,KAAqB,KAAA,KAAA,CAAzB,MAAA,EAA4C;AAC1C,YAAI,KAAJ,oBAAA,EAA+B;AAC7BJ,UAAAA,YAAY,CAAC,KAAbA,oBAAY,CAAZA;AACD;;AACD,aAAA,eAAA,GAAA,IAAA;AAEAG,QAAAA,MAAM,CAANA,QAAAA,CAAAA,CAAAA,EAAAA,CAAAA;AACA,aAAA,QAAA,CAAc;AACZJ,UAAAA,aAAa,EAAE;AADH,SAAd;AAGA,YAAMM,QAAQ,GAAGH,QAAQ,CAARA,gBAAAA,CAAjB,wBAAiBA,CAAjB;AACAI,QAAAA,KAAK,CAALA,SAAAA,CAAAA,KAAAA,CAAAA,KAAAA,CAAAA,QAAAA,EAAAA,OAAAA,CAA8C,UAAA,CAAA,EAAC;AAAA,iBAAKC,CAAC,CAADA,OAAAA,CAAAA,EAAAA,GAAL,EAAA;AAA/CD,SAAAA;AAEA,aAAA,oBAAA,GAA4BL,UAAU,CAAC,YAAM;AAC3C,UAAA,MAAI,CAAJ,cAAA;;AACA,UAAA,MAAI,CAAJ,eAAA,GAAA,KAAA;AAFoC,SAAA,EAAtC,GAAsC,CAAtC;AAID;;AACD,aAAA,IAAA;AACD;;;2CAEsB;AACrB,UAAI,KAAJ,gBAAA,EAA2B;AACzBD,QAAAA,YAAY,CAAC,KAAbA,gBAAY,CAAZA;AACD;;AACD,UAAI,KAAJ,aAAA,EAAwB;AACtBA,QAAAA,YAAY,CAAC,KAAbA,aAAY,CAAZA;AACD;;AACDE,MAAAA,QAAQ,CAARA,mBAAAA,CAAAA,QAAAA,EAAuC,KAAvCA,SAAAA,EAAAA,KAAAA;AACAC,MAAAA,MAAM,CAANA,mBAAAA,CAAAA,YAAAA,EAAyC,KAAzCA,aAAAA,EAAAA,KAAAA;AACD;;;sCAEiB;AAChB,UAAMK,kBAAkB,GAAG,KAAA,KAAA,CAAA,MAAA,CAAA,OAAA,CAAA,WAAA,EAAA,EAAA,EAAA,OAAA,CAAA,gBAAA,EAAA,EAAA,EAAA,OAAA,CAAA,6BAAA,EAAA,EAAA,EAAA,OAAA,CAAA,cAAA,EAAA,IAAA,EAAA,OAAA,CAAA,sBAAA,EAAA,IAAA,EAAA,OAAA,CAAA,kBAAA,EAAA,IAAA,EAA3B,IAA2B,EAA3B;AASA,UAAMC,WAAW,GAAjB,mBAAA;AACA,UAAMC,WAAW,GAAGF,kBAAkB,CAAlBA,KAAAA,CAApB,WAAoBA,CAApB;;AAEA,UAAI,CAAJ,WAAA,EAAkB;AAChB,eAAA,EAAA;AACD;;AAED,UAAMG,OAAO,GAAG,WAAW,CAAX,GAAA,CAAgB,UAAA,CAAA,EAAA,CAAA,EAAA;AAAA,eAAW;AACzCC,UAAAA,KAAK,EADoC,CAAA;AAEzCC,UAAAA,KAAK,EAAEC,CAAC,CAADA,KAAAA,CAAAA,MAAAA,EAAAA,CAAAA,EAFkC,MAAA;AAGzCC,UAAAA,IAAI,EAAED,CAAC,CAADA,OAAAA,CAAAA,WAAAA,EAAAA,IAAAA;AAHmC,SAAX;AAAhC,OAAgB,CAAhB;;AAMA,UAAME,UAAU,GAAG,SAAbA,UAAa,CAAA,KAAA,EAAK;AAAA,eAAI,OAAO,CAAP,MAAA,CAAe,UAAA,CAAA,EAAC;AAAA,iBAAIF,CAAC,CAADA,KAAAA,KAAJ,KAAA;AAAhB,SAAA,EAAJ,MAAA;AAAxB,OAAA;;AACA,UAAIG,UAAU,GAAd,CAAA;AACA,UAAIC,eAAe,GAAGF,UAAU,CAAhC,UAAgC,CAAhC;;AACA,aAAO,CAAP,eAAA,EAAyB;AACvBC,QAAAA,UAAU,IAAVA,CAAAA;AACAC,QAAAA,eAAe,GAAGF,UAAU,CAA5BE,UAA4B,CAA5BA;AACD;;AAED,UAAIC,MAAM,GAAV,CAAA;AACAR,MAAAA,OAAO,CAAPA,OAAAA,CAAgB,UAAA,CAAA,EAAK;AACnB,YAAIS,CAAC,CAADA,KAAAA,KAAJ,UAAA,EAA4B;AAC1BA,UAAAA,CAAC,CAADA,MAAAA,GAAWD,MAAM,CAAjBC,QAAWD,EAAXC;AACAD,UAAAA,MAAM,IAANA,CAAAA;AACD;AAJHR,OAAAA;AAOAA,MAAAA,OAAO,CAAPA,OAAAA,CAAgB,UAAA,CAAA,EAAA,CAAA,EAAU;AACxB,YAAI,CAACS,CAAC,CAAN,MAAA,EAAe;AACb,cAAIT,OAAO,CAACU,CAAC,GAATV,CAAO,CAAPA,IAAkBS,CAAC,CAADA,KAAAA,KAAYT,OAAO,CAACU,CAAC,GAATV,CAAO,CAAPA,CAAAA,KAAAA,GAAlC,CAAA,EAA4D;AAC1DS,YAAAA,CAAC,CAADA,MAAAA,GAAAA,GAAAA,MAAAA,CAAcT,OAAO,CAACU,CAAC,GAATV,CAAO,CAAPA,CAAdS,MAAAA,EAAAA,IAAAA,CAAAA;AADF,WAAA,MAEO,IAAIT,OAAO,CAACU,CAAC,GAATV,CAAO,CAAPA,IAAkBS,CAAC,CAADA,KAAAA,KAAYT,OAAO,CAACU,CAAC,GAATV,CAAO,CAAPA,CAAlC,KAAA,EAAwD;AAC7DS,YAAAA,CAAC,CAADA,MAAAA,GAAW,OAAO,CAACC,CAAC,GAAT,CAAO,CAAP,CAAA,MAAA,CAAA,OAAA,CAAA,gBAAA,EAET,UAAA,CAAA,EAAA,EAAA,EAAA,EAAA,EAAA;AAAA,qBAAA,GAAA,MAAA,CAAA,EAAA,EAAA,MAAA,CAAuBC,QAAQ,CAAA,EAAA,EAARA,EAAQ,CAARA,GAAvB,CAAA,CAAA;AAFFF,aAAW,CAAXA;AADK,WAAA,MAKA;AACLA,YAAAA,CAAC,CAADA,MAAAA,GAAAA,EAAAA;AACD;AACF;AAZHT,OAAAA;AAeA,UAAMY,MAAM,GAAG,OAAO,CAAP,GAAA,CAAY,UAAA,GAAA,EAAG;AAAA,eAAA,aAAA,CAAA,EAAA,EAAA,GAAA,EAAA;AAE5BJ,UAAAA,MAAM,EAAEK,GAAG,CAAHA,MAAAA,CAAAA,OAAAA,CAAAA,GAAAA,IAAAA,CAAAA,GAAAA,GAAAA,MAAAA,CAAiCA,GAAG,CAApCA,MAAAA,EAAAA,GAAAA,CAAAA,GAAiDA,GAAG,CAFhC,MAAA;AAG5BT,UAAAA,IAAI,EAAES,GAAG,CAACT;AAHkB,SAAA,CAAA;AAA9B,OAAe,CAAf;AAMA,aAAA,MAAA;AACD;;;mCAEcU,M,EAAQ;AAAA,UAAA,MAAA,GAAA,IAAA;;AACrB,UAAI,KAAJ,aAAA,EAAwB;AACtBzB,QAAAA,YAAY,CAAC,KAAbA,aAAY,CAAZA;AACD;;AAED,WAAA,aAAA,GAAqBC,UAAU,CAAC,YAAM;AACpC,YAAMyB,MAAM,GAAGxB,QAAQ,CAARA,aAAAA,CAAAA,cAAAA,MAAAA,CAAAA,MAAAA,EAAf,KAAeA,CAAAA,CAAf;;AACA,YAAIwB,MAAM,IAAI,OAAOA,MAAM,CAAb,SAAA,KAAd,QAAA,EAAoD;AAClDvB,UAAAA,MAAM,CAANA,QAAAA,CAAAA,CAAAA,EAAmBuB,MAAM,CAANA,SAAAA,GAAmB,MAAI,CAAJ,KAAA,CAAtCvB,gBAAAA;AACD;AAJ4B,OAAA,EAA/B,CAA+B,CAA/B;AAMD;;;qCAEgB;AAAA,UAAA,MAAA,GAAA,IAAA;;AACf,UAAMwB,SAAS,GAAGC,kBAAkB,CAClC,KAAA,KAAA,CAAA,WAAA,GACIzB,MAAM,CAANA,QAAAA,CAAAA,IAAAA,CAAAA,OAAAA,CAAAA,IAAAA,EAAAA,EAAAA,EADJ,IACIA,EADJ,GAEI,CAACA,MAAM,CAANA,QAAAA,CAAAA,IAAAA,CAAAA,KAAAA,CAAAA,cAAAA,KAAD,EAAA,EAHN,CAGM,CAH8B,CAApC;AAMA,WAAA,eAAA,GAAA,OAAA,CAA+B,UAAA,CAAA,EAAK;AAClC,YAAME,QAAQ,GAAGH,QAAQ,CAARA,gBAAAA,CAAAA,IAAAA,MAAAA,CAA8BkB,CAAC,CAAhD,KAAiBlB,CAAAA,CAAjB;AACA,YAAM2B,UAAU,GAAG,KAAK,CAAL,SAAA,CAAA,KAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA,CAEX,UAAA,CAAA,EAAC;AAAA,iBAAItB,CAAC,CAADA,SAAAA,KAAgBa,CAAC,CAAjBb,IAAAA,KAA2B,CAACA,CAAC,CAAF,OAAA,IAAc,CAACA,CAAC,CAADA,OAAAA,CAA9C,EAAIA,CAAJ;AAFT,SAAmB,CAAnB;;AAIA,YAAA,UAAA,EAAgB;AACdsB,UAAAA,UAAU,CAAVA,OAAAA,CAAAA,EAAAA,GAAwB,MAAI,CAAJ,KAAA,CAAA,WAAA,GACpBT,CAAC,CADmB,IAAA,GAAA,WAAA,MAAA,CAETA,CAAC,CAFhBS,KAAwB,CAAxBA;;AAIA,cAAIF,SAAS,IAAIA,SAAS,KAAKE,UAAU,CAAVA,OAAAA,CAA/B,EAAA,EAAsD;AACpD,YAAA,MAAI,CAAJ,cAAA,CAAA,SAAA;;AACA,YAAA,MAAI,CAAJ,QAAA,CAAc;AACZ9B,cAAAA,aAAa,EAAEqB,CAAC,CAACD;AADL,aAAd;AAGD;AACF;AAjBH,OAAA;AAmBD;;;qCAEgB;AAAA,UAAA,MAAA,GAAA,IAAA;;AACf,UAAMW,WAAW,GAAjB,EAAA;AAEA,WAAA,eAAA,GAAA,OAAA,CAA+B,UAAA,CAAA,EAAK;AAClC,YAAMzB,QAAQ,GAAGH,QAAQ,CAARA,gBAAAA,CAAAA,IAAAA,MAAAA,CAA8BkB,CAAC,CAAhD,KAAiBlB,CAAAA,CAAjB;AACA,YAAM2B,UAAU,GAAG,KAAK,CAAL,SAAA,CAAA,KAAA,CAAA,KAAA,CAAA,QAAA,EAAA,IAAA,CAGf,UAAA,CAAA,EAAC;AAAA,iBACCtB,CAAC,CAADA,SAAAA,KAAgBa,CAAC,CAAjBb,IAAAA,IACA,CAAC,WAAW,CAAX,IAAA,CAAiB,UAAA,CAAA,EAAC;AAAA,mBAAIwB,CAAC,CAADA,SAAAA,KAAgBxB,CAAC,CAArB,SAAA;AAFpB,WAEE,CAFF;AAHL,SAAmB,CAAnB;;AAOA,YAAA,UAAA,EAAgB;AACduB,UAAAA,WAAW,CAAXA,IAAAA,CAAiB;AACfL,YAAAA,MAAM,EAAE,MAAI,CAAJ,KAAA,CAAA,WAAA,GAAyBL,CAAC,CAA1B,IAAA,GAAA,WAAA,MAAA,CAA6CA,CAAC,CADvC,KACP,CADO;AAEfD,YAAAA,MAAM,EAAEC,CAAC,CAFM,MAAA;AAGfY,YAAAA,SAAS,EAAEH,UAAU,CAACG;AAHP,WAAjBF;AAKD;AAfH,OAAA;AAkBA,aAAA,WAAA;AACD;;;+BA2CUS,K,EAAO;AAChBpC,MAAAA,MAAM,CAANA,OAAAA,CAAAA,YAAAA,CAAAA,EAAAA,EAAAA,EAAAA,EAAAA,GAAAA,MAAAA,CAGKA,MAAM,CAANA,QAAAA,CAHLA,QAAAA,EAAAA,MAAAA,CAGgCA,MAAM,CAANA,QAAAA,CAHhCA,MAAAA,EAAAA,GAAAA,EAAAA,MAAAA,CAAAA,KAAAA,CAAAA;AAKD;;;6BAEQ;AAAA,UAAA,MAAA,GAAA,IAAA;;AACP,UAAMqC,OAAO,GAAG,KAAA,eAAA,GAAA,GAAA,CAA2B,UAAA,CAAA,EAAK;AAC9C,YAAMC,GAAG,GAAA,2BAAA,MAAA,CAA8BrB,CAAC,CAA/B,KAAA,EAAA,GAAA,EAAA,MAAA,CACP,MAAI,CAAJ,KAAA,CAAA,aAAA,KAA6BA,CAAC,CAA9B,MAAA,GAAA,QAAA,GADF,EAAS,CAAT;AAIA,eACE,MAAA,CAAA,OAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AACE,UAAA,SAAS,EADX,GAAA;AAEE,UAAA,OAAO,EAAE,SAAA,OAAA,CAAA,GAAA,EAAO;AACd,gBAAMsB,WAAW,GAAG,MAAI,CAAJ,KAAA,CAAA,WAAA,GAChBtB,CAAC,CADe,IAAA,GAAA,WAAA,MAAA,CAELA,CAAC,CAHF,KACM,CAApB,CADc,CAKd;;AACA,gBAAIA,CAAC,CAADA,MAAAA,KAAa,MAAI,CAAJ,KAAA,CAAjB,aAAA,EAA2C;AACzC;AACA,cAAA,MAAI,CAAJ,KAAA,CAAA,YAAA,CAAA,WAAA,EAAqC,MAAI,CAAzC,mBAAqC,EAArC;AARY,aAAA,CAWd;;;AACA,YAAA,MAAI,CAAJ,KAAA,CAAA,cAAA,CAAA,GAAA,EAA+BuB,GAAG,CAAlC,MAAA,EAAA,WAAA;;AAEA,YAAA,MAAI,CAAJ,UAAA,CAAA,WAAA;;AACA,YAAA,MAAI,CAAJ,cAAA,CAAA,WAAA;;AACA,YAAA,MAAI,CAAJ,QAAA,CAAc;AACZ5C,cAAAA,aAAa,EAAEqB,CAAC,CAACD;AADL,aAAd;AAlBJ,WAAA;AAsBE,UAAA,GAAG,EAAA,gBAAA,MAAA,CAAkBiB,IAAI,CAAJA,MAAAA,GAAAA,QAAAA,CAAAA,EAAAA,EAAAA,SAAAA,CAAlB,CAAkBA,CAAlB;AAtBL,SAAA,EAyBG,MAAI,CAAJ,KAAA,CAAA,OAAA,GAAqB,MAAA,CAAA,OAAA,CAAA,aAAA,CAAA,OAAA,EAAA,IAAA,EAAQhB,CAAC,CAA9B,MAAqB,CAArB,GAzBH,IAAA,EA0BGA,CAAC,CA3BN,IACE,CADF;AALF,OAAgB,CAAhB;AAqCA,aACE,MAAA,CAAA,OAAA,CAAA,aAAA,CAAA,KAAA,EAAA;AAAK,QAAA,SAAS,EAAA,uBAAA,MAAA,CAAyB,KAAA,KAAA,CAAzB,SAAA;AAAd,OAAA,EADF,OACE,CADF;AAKD;;;;EAtSiChC,MAAAA,CAAAA,S;;;;gBAAvBD,c,eACQ;AACjBE,EAAAA,MAAM,EAAEC,UAAAA,CAAAA,OAAAA,CAAAA,MAAAA,CADS,UAAA;AAEjBC,EAAAA,OAAO,EAAED,UAAAA,CAAAA,OAAAA,CAFQ,IAAA;AAGjBE,EAAAA,gBAAgB,EAAEF,UAAAA,CAAAA,OAAAA,CAHD,MAAA;AAIjBG,EAAAA,cAAc,EAAEH,UAAAA,CAAAA,OAAAA,CAJC,IAAA;AAKjBI,EAAAA,WAAW,EAAEJ,UAAAA,CAAAA,OAAAA,CALI,IAAA;AAMjBK,EAAAA,SAAS,EAAEL,UAAAA,CAAAA,OAAAA,CANM,MAAA;AAOjBM,EAAAA,cAAc,EAAEN,UAAAA,CAAAA,OAAAA,CAPC,IAAA;AAQjBO,EAAAA,YAAY,EAAEP,UAAAA,CAAAA,OAAAA,CAAUQ;AARP,C;;gBADRX,c,kBAYW;AACpBE,EAAAA,MAAM,EADc,EAAA;AAEpBE,EAAAA,OAAO,EAFa,IAAA;AAGpBC,EAAAA,gBAAgB,EAHI,CAAA;AAIpBC,EAAAA,cAAc,EAJM,IAAA;AAKpBC,EAAAA,WAAW,EALS,KAAA;AAMpBC,EAAAA,SAAS,EANW,EAAA;AAOpBC,EAAAA,cAAc,EAAE,SAAA,cAAA,GAAM,CAPF,CAAA;AAQpBC,EAAAA,YAAY,EAAE,SAAA,YAAA,GAAM,CAAE;AARF,C;;eA6RTV,c","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nexport class MarkdownNavbar extends Component {\n  static propTypes = {\n    source: PropTypes.string.isRequired,\n    ordered: PropTypes.bool,\n    headingTopOffset: PropTypes.number,\n    updateHashAuto: PropTypes.bool,\n    declarative: PropTypes.bool,\n    className: PropTypes.string,\n    onNavItemClick: PropTypes.func,\n    onHashChange: PropTypes.func,\n  };\n\n  static defaultProps = {\n    source: '',\n    ordered: true,\n    headingTopOffset: 0,\n    updateHashAuto: true,\n    declarative: false,\n    className: '',\n    onNavItemClick: () => {},\n    onHashChange: () => {},\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentListNo: '',\n    };\n  }\n\n  componentDidMount() {\n    if (this.addTargetTimeout) {\n      clearTimeout(this.addTargetTimeout);\n    }\n    this.addTargetTimeout = setTimeout(() => {\n      this.initHeadingsId();\n      document.addEventListener('scroll', this.winScroll, false);\n      window.addEventListener('hashchange', this.winHashChange, false);\n    }, 500);\n  }\n\n  shouldComponentUpdate(nextProps) {\n    if (nextProps.source !== this.props.source) {\n      if (this.scrollEventLockTimer) {\n        clearTimeout(this.scrollEventLockTimer);\n      }\n      this.scrollEventLock = true;\n\n      window.scrollTo(0, 0);\n      this.setState({\n        currentListNo: '',\n      });\n      const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');\n      Array.prototype.slice.apply(headings).forEach(h => (h.dataset.id = ''));\n\n      this.scrollEventLockTimer = setTimeout(() => {\n        this.initHeadingsId();\n        this.scrollEventLock = false;\n      }, 500);\n    }\n    return true;\n  }\n\n  componentWillUnmount() {\n    if (this.addTargetTimeout) {\n      clearTimeout(this.addTargetTimeout);\n    }\n    if (this.scrollTimeout) {\n      clearTimeout(this.scrollTimeout);\n    }\n    document.removeEventListener('scroll', this.winScroll, false);\n    window.removeEventListener('hashchange', this.winHashChange, false);\n  }\n\n  getNavStructure() {\n    const contentWithoutCode = this.props.source\n      .replace(/^[^#]+\\n/g, '')\n      .replace(/^#\\s[^#\\n]*\\n+/, '')\n      .replace(/```[^`\\n]*\\n+[^```]+```\\n+/g, '')\n      .replace(/`([^`\\n]+)`/g, '$1')\n      .replace(/\\*\\*?([^*\\n]+)\\*\\*?/g, '$1')\n      .replace(/__?([^_\\n]+)__?/g, '$1')\n      .trim();\n\n    const pattOfTitle = /#+\\s([^#\\n]+)\\n*/g;\n    const matchResult = contentWithoutCode.match(pattOfTitle);\n\n    if (!matchResult) {\n      return [];\n    }\n\n    const navData = matchResult.map((r, i) => ({\n      index: i,\n      level: r.match(/^#+/g)[0].length,\n      text: r.replace(pattOfTitle, '$1'),\n    }));\n\n    const levelCount = level => navData.filter(r => r.level === level).length;\n    let startLevel = 1;\n    let startLevelCount = levelCount(startLevel);\n    while (!startLevelCount) {\n      startLevel += 1;\n      startLevelCount = levelCount(startLevel);\n    }\n\n    let listNo = 1;\n    navData.forEach(t => {\n      if (t.level === startLevel) {\n        t.listNo = listNo.toString();\n        listNo += 1;\n      }\n    });\n\n    navData.forEach((t, i) => {\n      if (!t.listNo) {\n        if (navData[i - 1] && t.level === navData[i - 1].level + 1) {\n          t.listNo = `${navData[i - 1].listNo}.1`;\n        } else if (navData[i - 1] && t.level === navData[i - 1].level) {\n          t.listNo = navData[i - 1].listNo.replace(\n            /^(.+\\.)(\\d+)$/g,\n            (w, $1, $2) => `${$1}${parseInt($2, 10) + 1}`\n          );\n        } else {\n          t.listNo = '';\n        }\n      }\n    });\n\n    const result = navData.map(nav => ({\n      ...nav,\n      listNo: nav.listNo.indexOf('.') < 0 ? `${nav.listNo}.` : nav.listNo,\n      text: nav.text,\n    }));\n\n    return result;\n  }\n\n  scrollToTarget(dataId) {\n    if (this.scrollTimeout) {\n      clearTimeout(this.scrollTimeout);\n    }\n\n    this.scrollTimeout = setTimeout(() => {\n      const target = document.querySelector(`[data-id=\"${dataId}\"]`);\n      if (target && typeof target.offsetTop === 'number') {\n        window.scrollTo(0, target.offsetTop - this.props.headingTopOffset);\n      }\n    }, 0);\n  }\n\n  initHeadingsId() {\n    const headingId = decodeURIComponent(\n      this.props.declarative\n        ? window.location.hash.replace(/^#/, '').trim()\n        : (window.location.hash.match(/heading-\\d+/g) || [])[0]\n    );\n\n    this.getNavStructure().forEach(t => {\n      const headings = document.querySelectorAll(`h${t.level}`);\n      const curHeading = Array.prototype.slice\n        .apply(headings)\n        .find(h => h.innerText === t.text && (!h.dataset || !h.dataset.id));\n\n      if (curHeading) {\n        curHeading.dataset.id = this.props.declarative\n          ? t.text\n          : `heading-${t.index}`;\n\n        if (headingId && headingId === curHeading.dataset.id) {\n          this.scrollToTarget(headingId);\n          this.setState({\n            currentListNo: t.listNo,\n          });\n        }\n      }\n    });\n  }\n\n  getHeadingList() {\n    const headingList = [];\n\n    this.getNavStructure().forEach(t => {\n      const headings = document.querySelectorAll(`h${t.level}`);\n      const curHeading = Array.prototype.slice\n        .apply(headings)\n        .find(\n          h =>\n            h.innerText === t.text &&\n            !headingList.find(x => x.offsetTop === h.offsetTop)\n        );\n      if (curHeading) {\n        headingList.push({\n          dataId: this.props.declarative ? t.text : `heading-${t.index}`,\n          listNo: t.listNo,\n          offsetTop: curHeading.offsetTop,\n        });\n      }\n    });\n\n    return headingList;\n  }\n\n  getCurrentHashValue = () =>\n    decodeURIComponent(window.location.hash.replace(/^#/, ''));\n\n  winScroll = () => {\n    if (this.scrollEventLock) return;\n\n    const scrollTop =\n      window.pageYOffset ||\n      document.documentElement.scrollTop ||\n      document.body.scrollTop ||\n      0;\n\n    const newHeadingList = this.getHeadingList().map(h => ({\n      ...h,\n      distanceToTop: Math.abs(\n        scrollTop + this.props.headingTopOffset - h.offsetTop\n      ),\n    }));\n    const distanceList = newHeadingList.map(h => h.distanceToTop);\n    const minDistance = Math.min(...distanceList);\n    const curHeading = newHeadingList.find(\n      h => h.distanceToTop === minDistance\n    );\n\n    if (this.props.updateHashAuto) {\n      // Hash changing callback\n      if (curHeading.dataId !== this.getCurrentHashValue()) {\n        this.props.onHashChange(curHeading.dataId, this.getCurrentHashValue());\n      }\n\n      this.updateHash(curHeading.dataId);\n    }\n    this.setState({\n      currentListNo: curHeading.listNo,\n    });\n  };\n\n  winHashChange = () => {\n    this.scrollToTarget(this.getCurrentHashValue());\n  };\n\n  updateHash(value) {\n    window.history.replaceState(\n      {},\n      '',\n      `${window.location.pathname}${window.location.search}#${value}`\n    );\n  }\n\n  render() {\n    const tBlocks = this.getNavStructure().map(t => {\n      const cls = `title-anchor title-level${t.level} ${\n        this.state.currentListNo === t.listNo ? 'active' : ''\n      }`;\n\n      return (\n        <div\n          className={cls}\n          onClick={evt => {\n            const currentHash = this.props.declarative\n              ? t.text\n              : `heading-${t.index}`;\n\n            // Avoid execution the callback `onHashChange` when clicking current nav item\n            if (t.listNo !== this.state.currentListNo) {\n              // Hash changing callback\n              this.props.onHashChange(currentHash, this.getCurrentHashValue());\n            }\n\n            // Nav item clicking callback\n            this.props.onNavItemClick(evt, evt.target, currentHash);\n\n            this.updateHash(currentHash);\n            this.scrollToTarget(currentHash);\n            this.setState({\n              currentListNo: t.listNo,\n            });\n          }}\n          key={`title_anchor_${Math.random()\n            .toString(36)\n            .substring(2)}`}>\n          {this.props.ordered ? <small>{t.listNo}</small> : null}\n          {t.text}\n        </div>\n      );\n    });\n\n    return (\n      <div className={`markdown-navigation ${this.props.className}`}>\n        {tBlocks}\n      </div>\n    );\n  }\n}\n\nexport default MarkdownNavbar;\n"]},"metadata":{},"sourceType":"script"}